{% extends 'base.html' %}

{% block title %}Magellan EV - Projects{% endblock %}

{% block page_title %}Projects{% endblock %}

{% block header_actions %}
    <a href="{{ url_for('main.add_project') }}" class="btn btn-primary">
        <i class="fas fa-plus"></i> Add Project
    </a>
{% endblock %}

{% block content %}
    <div class="projects-grid">
        {% for project_data in projects_with_data %}
            <div class="project-card">
                <div class="project-header">
                    <h3>{{ project_data.project.name }}</h3>
                    <span class="project-id">{{ project_data.project.project_id_str }}</span>
                </div>
                
                <div class="project-body">
                    <p class="project-description">{{ project_data.project.description }}</p>
                    
                    <div class="project-metrics">
                        <div class="metric">
                            <span class="metric-label">Sub Jobs</span>
                            <span class="metric-value">{{ project_data.sub_job_count }}</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">Work Items</span>
                            <span class="metric-value">{{ project_data.work_item_count }}</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">Progress</span>
                            <div class="progress">
                                <div class="progress-bar" role="progressbar" 
                                     style="width: {{ project_data.overall_progress }}%;" 
                                     aria-valuenow="{{ project_data.overall_progress }}" 
                                     aria-valuemin="0" 
                                     aria-valuemax="100">
                                    {{ project_data.overall_progress|round|int }}%
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="project-footer">
                    <a href="{{ url_for('main.view_project', project_id=project_data.project.id) }}" class="btn btn-outline-light">
                        <i class="fas fa-eye"></i> View Details
                    </a>
                    <a href="{{ url_for('main.edit_project', project_id=project_data.project.id) }}" class="btn btn-outline-light">
                        <i class="fas fa-edit"></i> Edit
                    </a>
                    <button class="btn btn-outline-light" data-delete-action="{{ url_for('main.delete_project', project_id=project_data.project.id) }}" data-item-type="project">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                </div>
            </div>
        {% else %}
            <div class="no-data-message">
                <p>No projects found</p>
                <a href="{{ url_for('main.add_project') }}" class="btn btn-primary">Add Project</a>
            </div>
        {% endfor %}
    </div>
{% endblock %}
